[tools]
go = "1.26"

[tasks.build]
description = "Build the bbkt binary"
run = "go build -ldflags='-s -w' -o bin/bbkt ./cmd/bbkt"

[tasks.dev]
description = "Build and run in dev mode"
run = "go run ./cmd/bbkt"

[tasks.lint]
description = "Run linters"
run = "golangci-lint run ./..."

[tasks.test]
description = "Run tests"
run = "go test -race -count=1 ./..."

[tasks.install]
description = "Build and install bbkt to ~/.local/bin"
run = "./install.sh"

[tasks.link]
description = "Fast rebuild directly to ~/.local/bin/bbkt for rapid iteration"
run = "go build -ldflags='-s -w' -o ~/.local/bin/bbkt ./cmd/bbkt"

[tasks.fmt]
description = "Format code"
run = "gofumpt -w ."

[tasks.check]
description = "Run all checks"
depends = ["fmt", "lint", "test"]

[tasks.clean]
description = "Remove build artifacts"
run = "rm -rf bin/"
